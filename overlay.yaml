overlay: 1.0.0
info:
  title: Overlay epilot ERP Integration to make a ERP Integration resource
  version: 0.0.1
actions:
  - target: $
    update:
      x-speakeasy-retries:
        strategy: backoff
        backoff:
          initialInterval: 5000 # 5 seconds
          maxInterval: 60000 # 60 seconds
          maxElapsedTime: 3600000 # 5 minutes
          exponent: 1.5
        statusCodes:
          - 5XX
        retryConnectionErrors: true

  # v2 PUT is an upsert - use it for both create and update to have consistent schemas
  - target: $["paths"]["/v2/integrations/{integrationId}"]["put"]
    update:
      x-speakeasy-entity-operation: Integration#create,update
  - target: $["paths"]["/v2/integrations/{integrationId}"]["get"]
    update:
      x-speakeasy-entity-operation: Integration#read
  - target: $["paths"]["/v2/integrations/{integrationId}"]["delete"]
    update:
      x-speakeasy-entity-operation: Integration#delete

  # Integration parameter matchers for v2 endpoints
  - target: $["paths"]["/v2/integrations/{integrationId}"]["get"]["parameters"][0]
    update:
      x-speakeasy-match: id
  - target: $["paths"]["/v2/integrations/{integrationId}"]["put"]["parameters"][0]
    update:
      x-speakeasy-match: id
  - target: $["paths"]["/v2/integrations/{integrationId}"]["delete"]["parameters"][0]
    update:
      x-speakeasy-match: id

  # Integration entity schema - use IntegrationWithUseCases for v2 endpoints
  - target: $["components"]["schemas"]["IntegrationWithUseCases"]
    update:
      x-speakeasy-entity: Integration
